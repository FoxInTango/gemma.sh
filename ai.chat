#!/usr/bin/bash


URL=http://192.168.1.128:8081/
API_CHAT=completion
API_V1=v1/chat/completions

# Gemma is GOOD.
content="$1"
system_message="\"parameters\": { \"max_tokens\": 150,\"temperature\": 0.7,\"top_p\": 1,\"system_message\": \"YAMLæ˜¯è¡¨è¾¾å†…å®¹ç»“æ„å±‚çº§çš„å¥½æ–¹å¼\"}"
PROMPT=""
PROMPT=${PROMPT}"{\"n_predict\":256,\"messages\":["
PROMPT=${PROMPT}"{\"role\":\"system\",\"content\":\"ç®€å•è€Œå‡†ç¡®çš„å›ç­”ï¼Œå°±æ˜¯æœ€å¥½çš„å›ç­”.\"},"
PROMPT=${PROMPT}"{\"role\":\"user\",\"content\":\"${content}\",${system_message}}"
PROMPT=${PROMPT}"]"
PROMPT=${PROMPT}"}"
#PROMPT=${PROMPT}"æŠŠä¸‹é¢\`\`\` \`\`\`åŒ…å«çš„å†…å®¹åšå”¯ä¸€åˆ†ç±»æ˜ å°„ï¼ŒæŠŠå†…å®¹ç±»å‹æ˜ å°„åˆ°[å“²å­¦ å¯†ç å­¦ ç¼–ç¨‹ æ•°å­¦ ç»Ÿè®¡å­¦]ä¸­ã€‚å¹¶ç”¨å½¢å¦‚{content_id:id,class:classification}çš„çº¯ç²¹JSONæ•°æ®è¡¨è¾¾æ˜ å°„ç»“æœ"
#PROMPT=${PROMPT}" \`\`\`content_id : 1001 ,content : $1 \`\`\` "

answer=$(curl -s --request POST                                               \
     --url     ${URL}${API_V1}                                    \
     --header  "Content-Type: application/json"                   \
     -H        "Authorization: Bearer no-key"                     \
     --data    "${PROMPT}")     
echo "å›ç­” ï¼š"$answer
#,"{\"n_predict\": 128}"
#--data    "{\"prompt\":\"${PROMPT}\",\"n_predict\": 128}"

echo "\n"

# ./ai.node "æŠŠä¸‹é¢ é‡Œçš„å†…å®¹åšå”¯ä¸€åˆ†ç±»æ˜ å°„ï¼ŒæŠŠå†…å®¹ç±»å‹æ˜ å°„åˆ°[â€œå“²å­¦â€ â€œå¯†ç å­¦â€ â€œç¼–ç¨‹â€ â€œæ•°å­¦â€ â€œç»Ÿè®¡å­¦â€ï¼Œâ€œLinuxâ€]ä¸­ã€‚å¹¶ç”¨å½¢å¦‚{"content_id":"id","class":"classification"}çš„çº¯ç²¹JSONæ•°æ®è¡¨è¾¾æ˜ å°„ç»“æœã€‚å¦‚æœå®ƒä¸ç¬¦åˆä»»ä½•åˆ†ç±»ï¼Œå°±ç»™å‡ºå®ƒçš„å…³é”®è¯ã€‚content_id : 1001 ,content : Phiï¼Œè®©æˆ‘ä»¬ç ”ç©¶ä¸€ä¸‹ HTML + JavaScriptçš„ markdownæ¸²æŸ“å§ï¼Ÿ"./ai.node "æŠŠä¸‹é¢ é‡Œçš„å†…å®¹åšå”¯ä¸€åˆ†ç±»æ˜ å°„ï¼ŒæŠŠå†…å®¹ç±»å‹æ˜ å°„åˆ°[â€œå“²å­¦â€ â€œå¯†ç å­¦â€ â€œç¼–ç¨‹â€ â€œæ•°å­¦â€ â€œç»Ÿè®¡å­¦â€ï¼Œâ€œLinuxâ€]ä¸­ã€‚å¹¶ç”¨å½¢å¦‚{"content_id":"id","class":"classification"}çš„çº¯ç²¹JSONæ•°æ®è¡¨è¾¾æ˜ å°„ç»“æœã€‚å¦‚æœå®ƒä¸ç¬¦åˆä»»ä½•åˆ†ç±»ï¼Œå°±ç»™å‡ºå®ƒçš„å…³é”®è¯ã€‚content_id : 1001 ,content : Phiï¼Œè®©æˆ‘ä»¬ç ”ç©¶ä¸€ä¸‹ HTML + JavaScriptçš„ markdownæ¸²æŸ“å§ï¼Ÿ"
#
<< EOF
æ·»åŠ å‚æ•°ä»¥è°ƒæ•´æ¨¡å‹çš„è¡¨ç°å°†å–å†³äºæ‚¨ä¸LLMï¼ˆå¦‚llama-serverï¼‰äº¤äº’æ—¶ä½¿ç”¨çš„å…·ä½“APIã€‚å¤§å¤šæ•°LLMsæä¾›ä¸€ç»„å¯è°ƒæ•´çš„å‚æ•°ä»¥æ§åˆ¶ç”Ÿæˆçš„è¾“å‡ºï¼Œä¾‹å¦‚ temperatureã€max_tokensã€top_p ç­‰ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§å‚æ•°åŠå…¶æè¿°ï¼š

temperatureï¼šè°ƒæ•´è¾“å‡ºçš„å¤šæ ·æ€§ã€‚è¾ƒé«˜çš„å€¼ä¼šå¯¼è‡´æ›´æœ‰åˆ›é€ åŠ›çš„è¾“å‡ºï¼Œè€Œè¾ƒä½çš„å€¼ä¼šå¯¼è‡´æ›´ç¡®å®šå’Œé¢„æµ‹æ€§çš„è¾“å‡ºã€‚

max_tokensï¼šæŒ‡å®šç”Ÿæˆçš„æœ€å¤§è¾“å‡ºé•¿åº¦ã€‚

top_pï¼ˆä¹Ÿç§°ä¸º nucleus samplingï¼‰ï¼šä½¿ç”¨æ— åéšæœºé‡‡æ ·çš„é¡¶ç«¯påˆ†å¸ƒé€‰æ‹© tokenã€‚

relevance æˆ– presence_penaltyï¼šåœ¨æŸäº›æ¨¡å‹ä¸­ï¼Œå¯ç”¨ä»¥æ§åˆ¶ç”Ÿæˆå†…å®¹çš„ç›¸å…³æ€§æˆ–é¿å…é‡å¤ã€‚

frequency_penaltyï¼šç”¨äºå‡å°‘æ¨¡å‹ç”Ÿæˆä¸­é¢‘ç‡è¾ƒé«˜è¯è¯­çš„å¯èƒ½æ€§ã€‚

presence_penaltyï¼šç”¨äºå¢åŠ ç”Ÿæˆä¸­æ–°é¢–æˆ–ä¸åœ¨å¯¹è¯ä¸­å‡ºç°çš„è¯è¯­çš„å¯èƒ½æ€§ã€‚

ä»¥ä¸‹æ˜¯å¦‚ä½•åœ¨ä¸€ä¸ª JSON å¯¹è±¡ä¸­åŒ…å«è¿™äº›å‚æ•°çš„ç¤ºä¾‹ï¼š

ğŸ“‹ Copy
{
  "messages": [
    {
      "role": "system",
      "content": "ä½ çš„åå­—å«llamaï¼Œä½ æ˜¯å……æ»¡æ™ºæ…§çš„çµã€‚"
    },
    {
      "role": "user",
      "content": "æè¿°å¤ªé˜³ç³»çš„å†å²ã€‚",
      "parameters": {
        "max_tokens": 100,
        "temperature": 0.7,
        "top_p": 0.9
      }
    }
  ]
}
åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œparameters å­é›†ä»…é€‚ç”¨äº content å¯¹è±¡ä¸­çš„ user è§’è‰²ã€‚è¯·æ³¨æ„ï¼Œæ‚¨éœ€è¦æ£€æŸ¥LLMæ‰€æä¾›çš„APIæ–‡æ¡£ä»¥äº†è§£å¯ç”¨å‚æ•°ã€å®ƒä»¬çš„ä¸Šä¸‹æ–‡ä»¥åŠå¦‚ä½•æ­£ç¡®åœ°é…ç½®å®ƒä»¬ã€‚APIæ–‡æ¡£ä¼šæä¾›å¿…è¦çš„å¸®åŠ©ï¼Œä»¥ä¾¿æ‚¨èƒ½å¤Ÿæ ¹æ®æ‚¨çš„éœ€æ±‚è°ƒæ•´æ¨¡å‹çš„è¡¨ç°ã€‚
EOF
